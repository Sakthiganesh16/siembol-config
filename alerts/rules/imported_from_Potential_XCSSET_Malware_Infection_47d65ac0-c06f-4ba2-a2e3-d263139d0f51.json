{
  "rule_name" : "imported_from_Potential_XCSSET_Malware_Infection_47d65ac0-c06f-4ba2-a2e3-d263139d0f51",
  "rule_author" : "siembol",
  "rule_version": 1,
  "rule_description" : "Identifies the execution traces of the XCSSET malware. XCSSET is a macOS trojan that primarily spreads via Xcode projects and maliciously modifies applications. Infected users are also vulnerable to having their credentials, accounts, and other vital data stolen.",
  "source_type" : "macos",
  "matchers" : [ {
    "matchers" : [ {
      "matchers" : [ {
        "field" : "CommandLine",
        "data" : ".*\\Qhttps://\\E.*",
        "is_enabled" : true,
        "matcher_type" : "REGEX_MATCH",
        "is_negated" : false,
        "case_insensitive" : false,
        "starts_with" : false,
        "ends_with" : false
      }, {
        "matchers" : [ {
          "field" : "ParentImage",
          "data" : ".*\\Q/bash\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "Image",
          "data" : ".*\\Q/curl\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "CommandLine",
          "data" : ".*\\Q/sys/log.php\\E.*|.*\\Q/sys/prepod.php\\E.*|.*\\Q/sys/bin/Pods\\E.*",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        } ],
        "is_enabled" : true,
        "matcher_type" : "COMPOSITE_AND",
        "is_negated" : false,
        "case_insensitive" : false,
        "starts_with" : false,
        "ends_with" : false
      } ],
      "is_enabled" : true,
      "matcher_type" : "COMPOSITE_AND",
      "is_negated" : false,
      "case_insensitive" : false,
      "starts_with" : false,
      "ends_with" : false
    }, {
      "matchers" : [ {
        "matchers" : [ {
          "field" : "ParentImage",
          "data" : ".*\\Q/bash\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "Image",
          "data" : ".*\\Q/plutil\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "CommandLine",
          "data" : "(?=.*\\QLSUIElement\\E.*)(?=.*\\Q/Users/\\E.*)(?=.*\\Q/Library/Group Containers/\\E.*)",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        } ],
        "is_enabled" : true,
        "matcher_type" : "COMPOSITE_AND",
        "is_negated" : false,
        "case_insensitive" : false,
        "starts_with" : false,
        "ends_with" : false
      }, {
        "matchers" : [ {
          "field" : "Image",
          "data" : ".*\\Q/zip\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "CommandLine",
          "data" : "(?=.*\\Q-r\\E.*)(?=.*\\Q/Users/\\E.*)(?=.*\\Q/Library/Group Containers/\\E.*)",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        } ],
        "is_enabled" : true,
        "matcher_type" : "COMPOSITE_AND",
        "is_negated" : false,
        "case_insensitive" : false,
        "starts_with" : false,
        "ends_with" : false
      }, {
        "matchers" : [ {
          "field" : "ParentImage",
          "data" : ".*\\Q/bash\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "Image",
          "data" : ".*\\Q/osacompile\\E$",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        }, {
          "field" : "CommandLine",
          "data" : "(?=.*\\Q/Users/\\E.*)(?=.*\\Q/Library/Group Containers/\\E.*)",
          "is_enabled" : true,
          "matcher_type" : "REGEX_MATCH",
          "is_negated" : false,
          "case_insensitive" : false,
          "starts_with" : false,
          "ends_with" : false
        } ],
        "is_enabled" : true,
        "matcher_type" : "COMPOSITE_AND",
        "is_negated" : false,
        "case_insensitive" : false,
        "starts_with" : false,
        "ends_with" : false
      } ],
      "is_enabled" : true,
      "matcher_type" : "COMPOSITE_OR",
      "is_negated" : false,
      "case_insensitive" : false,
      "starts_with" : false,
      "ends_with" : false
    } ],
    "is_enabled" : true,
    "matcher_type" : "COMPOSITE_OR",
    "is_negated" : false,
    "case_insensitive" : false,
    "starts_with" : false,
    "ends_with" : false
  } ],
  "tags" : [ {
    "tag_name" : "sigma_id",
    "tag_value" : "47d65ac0-c06f-4ba2-a2e3-d263139d0f51"
  }, {
    "tag_name" : "sigma_tags",
    "tag_value" : "[attack.command_and_control]"
  }, {
    "tag_name" : "sigma_fp",
    "tag_value" : "[Unknown]"
  } ],
  "rule_protection" : {
    "max_per_hour" : 30,
    "max_per_day" : 100
  }
}